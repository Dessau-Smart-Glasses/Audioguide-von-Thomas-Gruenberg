<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dessau-Roßlau-Audioguide</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      text-align: center;
      padding: 2rem;
      background-color: #fafafa;
    }
    button {
      font-size: 1.2rem;
      padding: 0.8rem 1.5rem;
      border: none;
      border-radius: 12px;
      background-color: #0078d4;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #005ea1;
    }
    #status {
      margin-top: 1.5rem;
      font-size: 1rem;
      color: #333;
    }
  </style>
</head>
<body style="font-family: sans-serif; text-align: center; margin: 0; padding: 1.5em;">

  <h2 style="margin-bottom: 0.5em;">Schön, dass du da bist!</h2>

  <p style="margin-top: 0;">
    Erlebe Dessau-Roßlau per Audioguide und smarter Brille – 
    ein Projekt von <strong>Thomas Grünberg</strong>.<br><br>
    Dieser Guide ist die kompakte, digitale Begleitung zum Buch 
    und führt dich auf derselben Route – mit verkürzten Texten und klaren Stationen.
  </p>

  <p style="font-style: italic; margin: 1em 0;">
    Treffpunkt für den Start: die Wiese hinter den Plattenbauten am <strong>Heinz-Steyer-Ring</strong>, schräg links hinter <strong>Eisen-Maenicke</strong>.<br>
    (Ehemalige Hausnummer 12 – heute abgerissen)
  </p>

  <button 
    onclick="start()" 
    style="padding: 0.8em 1.2em; font-size: 1em; border-radius: 8px; border: none; 
           background-color: #007bff; color: white; cursor: pointer; margin-top: 1em;
           transition: background-color 0.3s;">
    Start
  </button>

  <p id="status" style="margin-top: 1.5em; font-size: 0.9em; color: #444;">
    GPS ist noch nicht aktiv...
  </p>

  <hr style="margin: 2em 0; border: none; border-top: 1px solid #ddd;">

  <p style="font-size: 0.8em; color: #555; line-height: 1.5;">
    <strong>Impressum & Datenschutz</strong><br>
    Verantwortlich im Sinne des §5 TMG: <strong>Thomas Grünberg</strong><br>
    Dieses Online-Angebot ist Teil eines kommerziellen Buchprojekts. 
    Die Nutzung des Audioguides ist auch ohne Buchkauf möglich.<br><br>
    Es werden keine personenbezogenen Daten gespeichert oder ausgewertet. 
    Die Standortdaten dienen ausschließlich der lokalen Positionsbestimmung auf deinem Gerät 
    und werden nicht an den Betreiber übermittelt. 
    Eine anonyme Zugriffszählung über GitHub Pages kann technisch bedingt stattfinden, 
    ohne dass Rückschlüsse auf einzelne Personen möglich sind.<br><br>
    Bereitgestellt über <em>GitHub Pages</em> (Betreiber: GitHub, Inc.).
  </p>

  <script>
    // -----------------------------
    //GPS-Ziele (Beispiele)
    // -----------------------------
    const spots = [
      {
        name: "Start im Heinz-Steyer-Ring",
        lat: 51.810997,
        lon: 12.252300,
        radius: 50, // Meter
        message: "Sie haben den Startbereich auf der Wiese im Heinz-Steyer-Ring erreicht. Jetzt kann es losgehen. "
               + "Das GPS funktioniert einwandfrei. "
               + "Fahren Sie auf der Straße nahe der Schrebergärten etwa 100 Meter in Richtung Kreuzbergschule. Anschließend erhalten Sie fortlaufend Richtungsangaben."
      },
      {
        name: "Heinz-Steyer-Ring 1",
        lat: 51.811399,
        lon: 12.251126,
        radius: 15, // Meter
        message: "Bleiben Sie bitte im Heinz-Steyer-Ring und biegen Sie nach etwa 20 Metern links ab. "
               + "Folgen Sie der Straßenführung etwa 110 Meter bis zur Kreuzbergschule. "
               + "Fahren Sie die Straße entlang, bis zur nächsten Mitteilung. "
      },
      {
        name: "Heinz-Steyer-Ring 2",
        lat: 51.811171,
        lon: 12.249749,
        radius: 15, // Meter
        message: "Biegen Sie links hinter der Kreuzbergschule in eine kleine Schlippe ein. "
               + "Fahren Sie die Strecke immer geradeaus und biegen Sie am Ende links in den Lorkgraben ab. "
        },
      {
        name: "Kreuzbergschule",
        lat: 51.810190,
        lon: 12.247783,
        radius: 15, // Meter
        message: "Biegen Sie jetzt links ab. "
               + "Fahren Sie bitte etwa 220 Meter geradeaus Richtung Lorkgraben. "
               + "Auf der linken Seite würden Sie später den ausgetrockneten Lorkteich sehen – Stichwort: Entengrütze. "
      },
     {
        name: "Lorkgraben",
        lat: 51.808591,
        lon: 12.248695,
        radius: 15, // Meter
        message: "Biegen Sie jetzt rechts in den Nordweg. "
               + "Die Reihenhäuser in den Straßen Großring, Mittelring und Kleinring gehören zur Siedlung Dessau-Törten. "
               + "Die Siedlung entstand zwischen 1926 und 1928 unter der Leitung von Walter Gropius, dem Gründer des Bauhauses. "
               + "Fahren Sie weiter geradeaus und biegen Sie dann rechts in die Doppelreihe ein. "
      },
      {
        name: "Moses-Mendelssohn-Zentrum",
        lat: 51.807230,
        lon: 12.247741,
        radius: 15, // Meter
        message: "Falls Sie einmal zum Moses-Mendelssohn-Zentrum möchten, biegen Sie jetzt links in den Mittelring ein und fahren Sie bis zur Hausnummer 38. "
               + "Ansonsten fahren Sie bitte weiter geradeaus und biegen Sie anschließend rechts in die Doppelreihe ein und fahren diese bis zur nächsten Kreuzung. "
               + "Schöne Grüße an Manu an dieser Stelle, hihi. "               
      },
      {
        name: "Doppelreihe",
        lat: 51.806291,
        lon: 12.246938,
        radius: 15, // Meter
        message: "Biegen Sie jetzt rechts in die Doppelreihe ein und fahren Sie bis zur Kreuzung. "
      },
      {
        name: "Bauhaus Stahlhaus",
        lat: 51.807259,
        lon: 12.243389,
        radius: 15, // Meter
        message: "Rechts sehen Sie die Sehenswürdigkeit Bauhaus Stahlhaus. "
                + "Das Stahlhaus gehört seit 1996 zum UNESCO-Welterbe. "
                + "Es wurde 1926/27 von Georg Muche und Richard Paulick im Auftrag der Dessauer Bauverwaltung errichtet. "
                + "Ziel war es, die industrielle Serienfertigung von Wohnhäusern zu erproben – mit Stahl als zentralem Baustoff. "  
                + "Bitte biegen Sie am Ende der Doppelreihe nach links ab und fahren Sie die Südstraße entlang. Danach biegen Sie erneut links in die Damaschkestraße ein. "   
      },
        {
        name: "Südstraße",
        lat: 51.806083,
        lon: 12.242236,
        radius: 15, // Meter
        message: "Bitte biegen Sie jetzt gleich links in die Damaschkestraße ein. "
                + "Fahren Sie die Damaschkestraße entlang, bis Sie zum Konsumgebäude am Dreieck kommen. "
      },
      {
        name: "Ende",
        lat: 54.293303,
        lon: 9.701214,
        radius: 15, // Meter
        message: "Sie haben das Ende des Audioguides erreicht! "
               + "Vielen Dank für Ihre Zeit, ich hoffe Sie hatten Spaß, schöne Grüße Thomas Grünberg "
          }
    ];

    let visited = new Set();

    //Text-to-Speech Funktion
    function speak(text) {
      const msg = new SpeechSynthesisUtterance(text);
      msg.lang = 'de-DE';
      msg.rate = 1;
      window.speechSynthesis.speak(msg);
    }

    //Entfernung zwischen 2 GPS-Punkten (Haversine-Formel)
    function distance(lat1, lon1, lat2, lon2) {
      const R = 6371e3;
      const φ1 = lat1 * Math.PI / 180;
      const φ2 = lat2 * Math.PI / 180;
      const Δφ = (lat2 - lat1) * Math.PI / 180;
      const Δλ = (lon2 - lon1) * Math.PI / 180;

      const a = Math.sin(Δφ / 2) ** 2 +
                Math.cos(φ1) * Math.cos(φ2) *
                Math.sin(Δλ / 2) ** 2;
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
      return R * c;
    }

    //Standort prüfen
    function checkLocation(pos) {
      const { latitude, longitude } = pos.coords;
      document.getElementById("status").innerText =
        `Aktuelle Position: ${latitude.toFixed(5)}, ${longitude.toFixed(5)}`;

      for (let spot of spots) {
        if (!visited.has(spot.name)) {
          const dist = distance(latitude, longitude, spot.lat, spot.lon);
          if (dist < spot.radius) {
            visited.add(spot.name);
            speak(spot.message);
            alert(spot.message);
          }
        }
      }
    }

    //Start-Button-Logik
    function start() {
      speak("Audioguide gestartet. Standort wird ermittelt.");
      if (navigator.geolocation) {
        navigator.geolocation.watchPosition(
          checkLocation,
          err => alert("GPS-Fehler: " + err.message),
          { enableHighAccuracy: true }
        );
      } else {
        alert("GPS wird nicht unterstützt.");
      }
    }
  </script>
</body>
</html>
